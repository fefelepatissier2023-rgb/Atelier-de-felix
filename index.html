<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>L‚ÄôAtelier de F√©lix - Commande</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* On garde ton magnifique style rose et marron */
    body { margin: 0; font-family: 'Segoe UI', sans-serif; background-color: #fff5f7; color: #5d4037; display: flex; flex-direction: column; align-items: center; padding: 20px; }
    .conteneur-patisserie { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-bottom: 30px; }
    .carte-photo { width: 120px; height: 120px; border-radius: 50%; overflow: hidden; border: 4px solid #f8bbd0; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    .carte-photo img { width: 100%; height: 100%; object-fit: cover; }
    .logo-img { max-width: 150px; height: auto; mix-blend-mode: multiply; margin-bottom: 15px; }
    .container-formulaire { background: white; padding: 25px; border-radius: 20px; width: 100%; max-width: 450px; border: 1px solid #f8bbd0; box-shadow: 0 10px 25px rgba(248, 187, 208, 0.4); }
    h1 { text-align: center; color: #ad1457; margin-bottom: 10px; font-size: 24px; }
    .note-paiement { background-color: #fce4ec; padding: 10px; border-radius: 8px; font-size: 13px; text-align: center; margin-bottom: 20px; border-left: 4px solid #ad1457; }
    label { display: block; margin-top: 15px; font-weight: bold; color: #ad1457; font-size: 14px; }
    input, textarea, select { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #ddd; box-sizing: border-box; margin-top: 5px; font-family: inherit; font-size: 14px; }
    .ligne-adresse { display: flex; gap: 10px; }
    .ligne-adresse div { flex: 1; }
    #zone-signature, #zone-autre, #zone-livraison-details, #zone-autre-parts { display: none; background: #fffbf0; padding: 15px; border-radius: 10px; margin-top: 15px; border: 1px dashed #ad1457; }
    .checkbox-container { background: #f9f9f9; padding: 15px; border-radius: 10px; margin-top: 20px; border: 1px solid #eee; display: flex; align-items: center; gap: 10px; }
    .rappel-prix { font-size: 12px; color: #ad1457; text-align: center; margin-top: 15px; font-style: italic; font-weight: bold; }
    button { width: 100%; padding: 15px; background: #ad1457; color: white; font-weight: bold; border: none; border-radius: 10px; cursor: pointer; margin-top: 10px; font-size: 16px; transition: 0.3s; }
    button:disabled { background: #ccc; }
  </style>
</head>
<body>

  <div class="conteneur-patisserie">
    <div class="carte-photo"><img src="7B8A818C-E3DD-4AA9-B4C3-F555C8444475.jpeg"></div>
    <div class="carte-photo"><img src="B52597EF-AAD8-456E-997D-98EF5EF39A12.jpg"></div>
    <div class="carte-photo"><img src="CDEC8BF6-99F0-46D7-AE0D-A82B147EBC3E.jpg"></div>
  </div>

  <img src="logo.png" alt="Logo L'Atelier de F√©lix" class="logo-img">

  <div class="container-formulaire">
    <h1>COMMANDE</h1>
    <p class="note-paiement">üç∞ <strong>On go√ªte d'abord, on paie apr√®s !</strong></p>

    <form id="orderForm">
      <label>Nom & Pr√©nom</label>
      <input type="text" id="nom" required>

      <div class="ligne-adresse">
        <div><label>Email</label><input type="email" id="email" required></div>
        <div><label>T√©l√©phone</label><input type="tel" id="tel" required></div>
      </div>

      <label>S√©lectionnez votre p√¢tisserie</label>
      <select id="gateau" onchange="verifierChoix()" required>
        <option value="" disabled selected>-- Faites votre choix --</option>
        <option value="Paris-Brest">Paris-Brest</option>
        <option value="Tiramisu">Tiramisu</option>
        <option value="Pavlova">Pavlova</option>
        <option value="Tropezienne">Trop√©zienne</option>
        <option value="Tarte au citron meringu√©e">Tarte au citron meringu√©e</option>
        <option value="Fraisier">Fraisier</option>
        <option value="Signature">‚ú® LE SIGNATURE</option>
        <option value="Autre">Autre g√¢teau...</option>
      </select>

      <label>Nombre de parts</label>
      <select id="nombre_parts" onchange="verifierParts()" required>
        <option value="2">2 parts</option>
        <option value="3">3 parts</option>
        <option value="4">4 parts</option>
        <option value="5">5 parts</option>
        <option value="6">6 parts</option>
        <option value="7">7 parts</option>
        <option value="8">8 parts</option>
        <option value="Autre">Autre nombre...</option>
      </select>

      <div id="zone-autre-parts"><label>Pr√©cisez :</label><input type="number" id="precision_parts"></div>
      <div id="zone-signature">
        <label>Go√ªt de la cr√®me</label><input type="text" id="signature_gout_1">
        <label>Go√ªt du c≈ìur fondant</label><input type="text" id="signature_gout_2">
      </div>
      <div id="zone-autre"><label>Quel g√¢teau ?</label><input type="text" id="autre_gateau_nom"></div>

      <label>Date souhait√©e</label>
      <input type="date" id="date" required>
      <label>Pr√©cisions</label>
      <textarea id="message" rows="2"></textarea>

      <div class="checkbox-container">
        <input type="checkbox" id="livraison" onchange="verifierLivraison()">
        <label for="livraison">üöó Je souhaite √™tre livr√© √† domicile</label>
      </div>

      <div id="zone-livraison-details">
        <label>Adresse (Rue)</label><input type="text" id="rue_livraison">
        <label>Appartement / Pr√©cisions</label><input type="text" id="appartement_details">
        <div class="ligne-adresse">
          <div><label>√âtage</label><input type="text" id="etage"></div>
          <div><label>CP</label><input type="text" id="cp_livraison"></div>
        </div>
        <label>Heure souhait√©e</label><input type="time" id="heure_livraison">
      </div>

      <p class="rappel-prix">Le prix sera d√©cid√© apr√®s d√©gustation. ‚úÖ</p>
      <button type="submit" id="submitBtn">Valider ma commande üç∞</button>
    </form>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBwMCXfgxkb6Bp50Co0Qn5_ANDG1RCfgLU",
      authDomain: "l-atelier-de-felix.firebaseapp.com",
      projectId: "l-atelier-de-felix",
      storageBucket: "l-atelier-de-felix.firebasestorage.app",
      messagingSenderId: "667382759870",
      appId: "1:667382759870:web:f5775b881ba8bbe456b9ef"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    window.verifierChoix = () => {
      const val = document.getElementById("gateau").value;
      document.getElementById("zone-signature").style.display = (val === "Signature") ? "block" : "none";
      document.getElementById("zone-autre").style.display = (val === "Autre") ? "block" : "none";
    };

    window.verifierParts = () => {
      document.getElementById("zone-autre-parts").style.display = (document.getElementById("nombre_parts").value === "Autre") ? "block" : "none";
    };

    window.verifierLivraison = () => {
      document.getElementById("zone-livraison-details").style.display = document.getElementById("livraison").checked ? "block" : "none";
    };

    document.getElementById("orderForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const btn = document.getElementById("submitBtn");
      btn.disabled = true;
      btn.innerText = "Envoi en cours...";

      try {
        await addDoc(collection(db, "commandes"), {
          client: document.getElementById("nom").value,
          email: document.getElementById("email").value,
          tel: document.getElementById("tel").value,
          gateau: document.getElementById("gateau").value,
          parts: document.getElementById("nombre_parts").value,
          date: document.getElementById("date").value,
          livraison: document.getElementById("livraison").checked,
          adresse: document.getElementById("rue_livraison").value,
          timestamp: serverTimestamp()
        });
        alert("Commande envoy√©e ! F√©lix vous recontactera bient√¥t. üç∞");
        document.getElementById("orderForm").reset();
      } catch (e) {
        alert("Erreur : " + e.message);
      }
      btn.disabled = false;
      btn.innerText = "Valider ma commande üç∞";
    });
  </script>
</body>
</html>
